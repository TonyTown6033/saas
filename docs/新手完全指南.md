# æ–°æ‰‹å®Œå…¨æŒ‡å—

æ¬¢è¿æ¥åˆ°å¾®æœåŠ¡çƒ­æ’æ‹” SAAS å¹³å°ï¼æœ¬æŒ‡å—å°†ä»é›¶å¼€å§‹ï¼Œæ‰‹æŠŠæ‰‹æ•™ä½ å¦‚ä½•ä½¿ç”¨å’Œå¼€å‘è¿™ä¸ªå¹³å°ã€‚

## ğŸ“š ç›®å½•

1. [é¡¹ç›®ä»‹ç»](#é¡¹ç›®ä»‹ç»)
2. [æ ¸å¿ƒæ¦‚å¿µ](#æ ¸å¿ƒæ¦‚å¿µ)
3. [ç¯å¢ƒå‡†å¤‡](#ç¯å¢ƒå‡†å¤‡)
4. [ç¬¬ä¸€æ¬¡å¯åŠ¨](#ç¬¬ä¸€æ¬¡å¯åŠ¨)
5. [ç†è§£ç³»ç»Ÿç»„ä»¶](#ç†è§£ç³»ç»Ÿç»„ä»¶)
6. [åˆ›å»ºç¬¬ä¸€ä¸ªæ’ä»¶](#åˆ›å»ºç¬¬ä¸€ä¸ªæ’ä»¶)
7. [å‰ç«¯å¼€å‘](#å‰ç«¯å¼€å‘)
8. [å¸¸è§é—®é¢˜](#å¸¸è§é—®é¢˜)

---

## é¡¹ç›®ä»‹ç»

### è¿™æ˜¯ä»€ä¹ˆï¼Ÿ

è¿™æ˜¯ä¸€ä¸ª**æ”¯æŒçƒ­æ’æ‹”å¾®æœåŠ¡çš„ SAAS å¹³å°**ã€‚ç®€å•æ¥è¯´ï¼š

- ğŸ”Œ **çƒ­æ’æ‹”**ï¼šä½ å¯ä»¥éšæ—¶æ·»åŠ æˆ–ç§»é™¤æœåŠ¡ï¼Œä¸éœ€è¦é‡å¯æ•´ä¸ªç³»ç»Ÿ
- ğŸ—ï¸ **å¾®æœåŠ¡**ï¼šæ¯ä¸ªåŠŸèƒ½éƒ½æ˜¯ç‹¬ç«‹çš„å°æœåŠ¡ï¼Œäº’ä¸å¹²æ‰°
- ğŸš€ **SAAS å¹³å°**ï¼šå¤šç§Ÿæˆ·ã€ç”¨æˆ·ç®¡ç†ã€æƒé™æ§åˆ¶ç­‰ä¼ä¸šçº§åŠŸèƒ½éƒ½å·²å†…ç½®

### ä½ èƒ½ç”¨å®ƒåšä»€ä¹ˆï¼Ÿ

- âœ… å¿«é€Ÿæ­å»ºå¤šç§Ÿæˆ· SAAS åº”ç”¨
- âœ… å¼€å‘å¯ç‹¬ç«‹éƒ¨ç½²çš„ä¸šåŠ¡æ¨¡å—
- âœ… å®ç°ä¼ä¸šçº§çš„å¾®æœåŠ¡æ¶æ„
- âœ… å­¦ä¹ å¾®æœåŠ¡ã€æœåŠ¡æ³¨å†Œã€API ç½‘å…³ç­‰æŠ€æœ¯

### æŠ€æœ¯æ ˆ

**åç«¯ï¼š**
- Python 3.11
- FastAPIï¼ˆWeb æ¡†æ¶ï¼‰
- PostgreSQLï¼ˆæ•°æ®åº“ï¼‰
- Redisï¼ˆç¼“å­˜ï¼‰

**å‰ç«¯ï¼š**
- Vue 3
- Vite
- Axios

---

## æ ¸å¿ƒæ¦‚å¿µ

åœ¨å¼€å§‹ä¹‹å‰ï¼Œç†è§£è¿™å‡ ä¸ªæ ¸å¿ƒæ¦‚å¿µå¾ˆé‡è¦ï¼š

### 1. æœåŠ¡æ³¨å†Œä¸­å¿ƒï¼ˆRegistryï¼‰

æƒ³è±¡å®ƒæ˜¯ä¸€ä¸ª"ç”µè¯ç°¿"ï¼š
- æ‰€æœ‰å¾®æœåŠ¡å¯åŠ¨æ—¶éƒ½è¦åœ¨è¿™é‡Œ"ç™»è®°"
- è®°å½•æ¯ä¸ªæœåŠ¡çš„åç§°ã€åœ°å€ã€ç«¯å£
- å®šæœŸæ£€æŸ¥æœåŠ¡æ˜¯å¦è¿˜"æ´»ç€"ï¼ˆå¿ƒè·³ï¼‰

### 2. API ç½‘å…³ï¼ˆGatewayï¼‰

æƒ³è±¡å®ƒæ˜¯ä¸€ä¸ª"å‰å°æ¥å¾…"ï¼š
- æ‰€æœ‰è¯·æ±‚éƒ½å…ˆåˆ°ç½‘å…³
- ç½‘å…³æŸ¥"ç”µè¯ç°¿"æ‰¾åˆ°å¯¹åº”çš„æœåŠ¡
- æŠŠè¯·æ±‚è½¬å‘ç»™æ­£ç¡®çš„æœåŠ¡

### 3. æ ¸å¿ƒæœåŠ¡ï¼ˆCoreï¼‰

æä¾›åŸºç¡€åŠŸèƒ½ï¼š
- ç”¨æˆ·æ³¨å†Œå’Œç™»å½•
- ç§Ÿæˆ·ç®¡ç†
- æƒé™æ§åˆ¶

### 4. çƒ­æ’æ‹”æœåŠ¡ï¼ˆPluginsï¼‰

ä½ è‡ªå·±å¼€å‘çš„ä¸šåŠ¡æœåŠ¡ï¼š
- å¯ä»¥éšæ—¶å¯åŠ¨æˆ–åœæ­¢
- è‡ªåŠ¨æ³¨å†Œåˆ°ç³»ç»Ÿä¸­
- é€šè¿‡ç½‘å…³å°±èƒ½è®¿é—®

### æµç¨‹å›¾

```
ç”¨æˆ·è¯·æ±‚ â†’ APIç½‘å…³ â†’ æŸ¥è¯¢æ³¨å†Œä¸­å¿ƒ â†’ æ‰¾åˆ°æœåŠ¡ â†’ è½¬å‘è¯·æ±‚ â†’ è¿”å›ç»“æœ
```

---

## ç¯å¢ƒå‡†å¤‡

### æ–¹å¼ä¸€ï¼šä½¿ç”¨ Dockerï¼ˆæœ€ç®€å•ï¼Œæ¨èæ–°æ‰‹ï¼‰

åªéœ€è¦å®‰è£… Dockerï¼š

- **Mac**: ä¸‹è½½ [Docker Desktop for Mac](https://www.docker.com/products/docker-desktop)
- **Windows**: ä¸‹è½½ [Docker Desktop for Windows](https://www.docker.com/products/docker-desktop)
- **Linux**:
  ```bash
  curl -fsSL https://get.docker.com -o get-docker.sh
  sudo sh get-docker.sh
  ```

### æ–¹å¼äºŒï¼šæœ¬åœ°å¼€å‘ï¼ˆæ›´çµæ´»ï¼‰

éœ€è¦å®‰è£…ï¼š

1. **Python 3.11+**
   ```bash
   # Mac (ä½¿ç”¨ Homebrew)
   brew install pyenv
   pyenv install 3.11
   pyenv global 3.11

   # å®‰è£… uv (Python åŒ…ç®¡ç†å™¨)
   pip install uv
   ```

2. **PostgreSQL 14+**
   ```bash
   # Mac
   brew install postgresql@14
   brew services start postgresql@14

   # æˆ–è€…ä½¿ç”¨ Docker
   docker run -d --name postgres \
     -e POSTGRES_PASSWORD=saas_password \
     -e POSTGRES_USER=saas_user \
     -e POSTGRES_DB=saas_platform \
     -p 5432:5432 postgres:14
   ```

3. **Redis**
   ```bash
   # Mac
   brew install redis
   brew services start redis

   # æˆ–è€…ä½¿ç”¨ Docker
   docker run -d --name redis -p 6379:6379 redis:7
   ```

4. **Node.js 18+**ï¼ˆå‰ç«¯å¼€å‘éœ€è¦ï¼‰
   ```bash
   # Mac
   brew install node@18
   ```

---

## ç¬¬ä¸€æ¬¡å¯åŠ¨

### ğŸš€ ä½¿ç”¨ Dockerï¼ˆæ¨èï¼‰

**æ­¥éª¤ 1ï¼šå…‹éš†é¡¹ç›®**
```bash
cd ~/Projects
git clone <your-repo-url> SAAS
cd SAAS
```

**æ­¥éª¤ 2ï¼šå¯åŠ¨æ‰€æœ‰æœåŠ¡**
```bash
docker-compose up -d
```

**æ­¥éª¤ 3ï¼šæ£€æŸ¥æœåŠ¡çŠ¶æ€**
```bash
docker-compose ps
```

ä½ åº”è¯¥çœ‹åˆ°æ‰€æœ‰æœåŠ¡éƒ½æ˜¯ "Up" çŠ¶æ€ã€‚

**æ­¥éª¤ 4ï¼šè®¿é—®æœåŠ¡**

æ‰“å¼€æµè§ˆå™¨è®¿é—®ï¼š
- API ç½‘å…³æ–‡æ¡£ï¼šhttp://localhost:8000/docs
- æ³¨å†Œä¸­å¿ƒæ–‡æ¡£ï¼šhttp://localhost:8001/docs
- æ ¸å¿ƒæœåŠ¡æ–‡æ¡£ï¼šhttp://localhost:8002/docs

### ğŸ’» æœ¬åœ°å¼€å‘æ–¹å¼

**æ­¥éª¤ 1ï¼šå®‰è£…åç«¯ä¾èµ–**
```bash
cd backend

# åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
uv venv

# æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ
source .venv/bin/activate  # Mac/Linux
# æˆ–
.venv\Scripts\activate  # Windows

# å®‰è£…ä¾èµ–
uv pip install -r requirements.txt
```

**æ­¥éª¤ 2ï¼šé…ç½®ç¯å¢ƒå˜é‡**
```bash
# å¤åˆ¶ç¯å¢ƒå˜é‡ç¤ºä¾‹
cp .env.example .env

# ç¼–è¾‘ .env æ–‡ä»¶ï¼ˆå¯é€‰ï¼‰
vim .env
```

**æ­¥éª¤ 3ï¼šå¯åŠ¨æ•°æ®åº“**
```bash
# å›åˆ°é¡¹ç›®æ ¹ç›®å½•
cd ..

# å¯åŠ¨ PostgreSQL å’Œ Redis
docker-compose up -d postgres redis
```

**æ­¥éª¤ 4ï¼šå¯åŠ¨æ ¸å¿ƒæœåŠ¡**

æ‰“å¼€ **3 ä¸ªç»ˆç«¯**ï¼Œåˆ†åˆ«è¿è¡Œï¼š

**ç»ˆç«¯ 1 - æœåŠ¡æ³¨å†Œä¸­å¿ƒï¼š**
```bash
cd backend/registry
source ../.venv/bin/activate
python main.py
```
ç­‰å¾…çœ‹åˆ°ï¼š`Uvicorn running on http://0.0.0.0:8001`

**ç»ˆç«¯ 2 - API ç½‘å…³ï¼š**
```bash
cd backend/gateway
source ../.venv/bin/activate
python main.py
```
ç­‰å¾…çœ‹åˆ°ï¼š`Uvicorn running on http://0.0.0.0:8000`

**ç»ˆç«¯ 3 - æ ¸å¿ƒæœåŠ¡ï¼š**
```bash
cd backend/core
source ../.venv/bin/activate
python main.py
```
ç­‰å¾…çœ‹åˆ°ï¼š`Uvicorn running on http://0.0.0.0:8002`

**æ­¥éª¤ 5ï¼šéªŒè¯å®‰è£…**

æ‰“å¼€æ–°ç»ˆç«¯ï¼Œè¿è¡Œæµ‹è¯•ï¼š
```bash
# æµ‹è¯•æ³¨å†Œä¸­å¿ƒ
curl http://localhost:8001

# æµ‹è¯•ç½‘å…³
curl http://localhost:8000

# æµ‹è¯•æ ¸å¿ƒæœåŠ¡
curl http://localhost:8002

# æŸ¥çœ‹å·²æ³¨å†Œçš„æœåŠ¡
curl http://localhost:8001/api/registry/services
```

---

## ç†è§£ç³»ç»Ÿç»„ä»¶

### æœåŠ¡ç«¯å£åˆ†é…

| æœåŠ¡ | ç«¯å£ | è¯´æ˜ |
|------|------|------|
| API ç½‘å…³ | 8000 | ç»Ÿä¸€å…¥å£ |
| æœåŠ¡æ³¨å†Œä¸­å¿ƒ | 8001 | æœåŠ¡æ³¨å†Œå’Œå‘ç° |
| æ ¸å¿ƒæœåŠ¡ | 8002 | ç”¨æˆ·ã€ç§Ÿæˆ·ã€è®¤è¯ |
| æ¼”ç¤ºæœåŠ¡ | 8003 | ç¤ºä¾‹æ’ä»¶ |
| Dashboard æœåŠ¡ | 8004 | ä»ªè¡¨æ¿æ’ä»¶ |
| å‰ç«¯ | 5173 | Vue ç®¡ç†ç•Œé¢ |
| PostgreSQL | 5432 | æ•°æ®åº“ |
| Redis | 6379 | ç¼“å­˜ |

### é¡¹ç›®ç›®å½•ç»“æ„

```
SAAS/
â”œâ”€â”€ backend/                  # åç«¯ä»£ç 
â”‚   â”œâ”€â”€ gateway/             # API ç½‘å…³
â”‚   â”‚   â””â”€â”€ main.py         # ç½‘å…³ä¸»ç¨‹åº
â”‚   â”œâ”€â”€ registry/            # æœåŠ¡æ³¨å†Œä¸­å¿ƒ
â”‚   â”‚   â””â”€â”€ main.py         # æ³¨å†Œä¸­å¿ƒä¸»ç¨‹åº
â”‚   â”œâ”€â”€ core/                # æ ¸å¿ƒæœåŠ¡
â”‚   â”‚   â””â”€â”€ main.py         # æ ¸å¿ƒæœåŠ¡ä¸»ç¨‹åº
â”‚   â”œâ”€â”€ shared/              # å…±äº«ä»£ç 
â”‚   â”‚   â”œâ”€â”€ models/         # æ•°æ®åº“æ¨¡å‹
â”‚   â”‚   â”œâ”€â”€ schemas/        # Pydantic æ•°æ®éªŒè¯
â”‚   â”‚   â”œâ”€â”€ utils/          # å·¥å…·å‡½æ•°
â”‚   â”‚   â”œâ”€â”€ config.py       # é…ç½®ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ database.py     # æ•°æ®åº“è¿æ¥
â”‚   â”‚   â””â”€â”€ dependencies.py # FastAPI ä¾èµ–æ³¨å…¥
â”‚   â”œâ”€â”€ requirements.txt     # Python ä¾èµ–åˆ—è¡¨
â”‚   â””â”€â”€ .env                # ç¯å¢ƒå˜é‡é…ç½®
â”‚
â”œâ”€â”€ frontend/                # å‰ç«¯ä»£ç 
â”‚   â””â”€â”€ admin/              # Vue ç®¡ç†åå°
â”‚       â”œâ”€â”€ src/            # æºä»£ç 
â”‚       â””â”€â”€ package.json    # å‰ç«¯ä¾èµ–
â”‚
â”œâ”€â”€ examples/                # ç¤ºä¾‹ä»£ç 
â”‚   â””â”€â”€ plugins/            # æ’ä»¶ç¤ºä¾‹
â”‚       â”œâ”€â”€ demo-service/   # æ¼”ç¤ºæœåŠ¡
â”‚       â””â”€â”€ dashboard-service/ # ä»ªè¡¨æ¿æœåŠ¡
â”‚
â”œâ”€â”€ docs/                    # æ–‡æ¡£
â”‚   â”œâ”€â”€ QUICKSTART.md       # å¿«é€Ÿå¼€å§‹
â”‚   â”œâ”€â”€ PLUGIN_DEVELOPMENT.md # æ’ä»¶å¼€å‘
â”‚   â””â”€â”€ ARCHITECTURE.md     # æ¶æ„è¯´æ˜
â”‚
â”œâ”€â”€ scripts/                 # è„šæœ¬
â”‚   â”œâ”€â”€ test-system.sh      # ç³»ç»Ÿæµ‹è¯•è„šæœ¬
â”‚   â””â”€â”€ start-all-services.sh # å¯åŠ¨æ‰€æœ‰æœåŠ¡
â”‚
â”œâ”€â”€ docker-compose.yml       # Docker ç¼–æ’é…ç½®
â””â”€â”€ README.md               # é¡¹ç›®è¯´æ˜
```

### æ•°æ®æµåŠ¨ç¤ºä¾‹

è®©æˆ‘ä»¬é€šè¿‡ä¸€ä¸ªå®é™…ä¾‹å­ç†è§£æ•°æ®å¦‚ä½•æµåŠ¨ï¼š

**åœºæ™¯ï¼šç”¨æˆ·ç™»å½•**

1. ç”¨æˆ·åœ¨å‰ç«¯è¾“å…¥ç”¨æˆ·åå’Œå¯†ç 
2. å‰ç«¯å‘é€è¯·æ±‚åˆ°ç½‘å…³ï¼š`POST http://localhost:8000/api/core/auth/login`
3. ç½‘å…³æŸ¥è¯¢æ³¨å†Œä¸­å¿ƒï¼šæ‰¾åˆ° `core` æœåŠ¡çš„åœ°å€
4. ç½‘å…³è½¬å‘è¯·æ±‚åˆ°æ ¸å¿ƒæœåŠ¡ï¼š`http://localhost:8002/auth/login`
5. æ ¸å¿ƒæœåŠ¡éªŒè¯ç”¨æˆ·åå¯†ç ï¼Œç”Ÿæˆ JWT ä»¤ç‰Œ
6. æ ¸å¿ƒæœåŠ¡è¿”å›ä»¤ç‰Œç»™ç½‘å…³
7. ç½‘å…³è¿”å›ä»¤ç‰Œç»™å‰ç«¯
8. å‰ç«¯ä¿å­˜ä»¤ç‰Œï¼Œåç»­è¯·æ±‚éƒ½æºå¸¦è¿™ä¸ªä»¤ç‰Œ

---

## åˆ›å»ºç¬¬ä¸€ä¸ªæ’ä»¶

è®©æˆ‘ä»¬ä»é›¶å¼€å§‹ï¼Œåˆ›å»ºä¸€ä¸ªç®€å•çš„"å¾…åŠäº‹é¡¹"æœåŠ¡ã€‚

### æ­¥éª¤ 1ï¼šåˆ›å»ºé¡¹ç›®ç›®å½•

```bash
# åœ¨ examples/plugins ä¸‹åˆ›å»ºæ–°ç›®å½•
mkdir -p examples/plugins/todo-service
cd examples/plugins/todo-service
```

### æ­¥éª¤ 2ï¼šåˆ›å»º main.py

```python
"""
å¾…åŠäº‹é¡¹æœåŠ¡ - æˆ‘çš„ç¬¬ä¸€ä¸ªçƒ­æ’æ‹”æ’ä»¶
"""
from fastapi import FastAPI, HTTPException
from pydantic import BaseModel
import httpx
import asyncio
from typing import List, Optional

# åˆ›å»º FastAPI åº”ç”¨
app = FastAPI(
    title="Todo Service",
    description="ç®€å•çš„å¾…åŠäº‹é¡¹ç®¡ç†æœåŠ¡",
    version="1.0.0"
)

# ==================== æœåŠ¡é…ç½® ====================

REGISTRY_URL = "http://localhost:8001"

SERVICE_CONFIG = {
    "name": "todo-service",
    "display_name": "å¾…åŠäº‹é¡¹æœåŠ¡",
    "description": "ç®¡ç†ä½ çš„å¾…åŠäº‹é¡¹",
    "version": "1.0.0",
    "host": "localhost",
    "port": 8100,  # ä½¿ç”¨æ–°ç«¯å£
    "base_path": "/",
    "health_check_url": "/health",
    "service_metadata": {
        "author": "Your Name",
        "category": "productivity",
    },
    "tags": ["todo", "productivity"],
    "requires_auth": False,
    "endpoints": [
        {
            "path": "/todos",
            "method": "GET",
            "description": "è·å–æ‰€æœ‰å¾…åŠäº‹é¡¹",
            "is_public": True,
        },
        {
            "path": "/todos",
            "method": "POST",
            "description": "åˆ›å»ºæ–°å¾…åŠäº‹é¡¹",
            "is_public": True,
        },
        {
            "path": "/todos/{todo_id}",
            "method": "PUT",
            "description": "æ›´æ–°å¾…åŠäº‹é¡¹",
            "is_public": True,
        },
        {
            "path": "/todos/{todo_id}",
            "method": "DELETE",
            "description": "åˆ é™¤å¾…åŠäº‹é¡¹",
            "is_public": True,
        },
    ],
}

# ==================== æ•°æ®æ¨¡å‹ ====================

class TodoCreate(BaseModel):
    title: str
    description: Optional[str] = ""
    completed: bool = False

class TodoUpdate(BaseModel):
    title: Optional[str] = None
    description: Optional[str] = None
    completed: Optional[bool] = None

class Todo(BaseModel):
    id: int
    title: str
    description: str
    completed: bool

# å†…å­˜å­˜å‚¨ï¼ˆç®€å•èµ·è§ï¼Œç”Ÿäº§ç¯å¢ƒåº”è¯¥ä½¿ç”¨æ•°æ®åº“ï¼‰
todos: List[Todo] = []
todo_id_counter = 1

# ==================== æœåŠ¡æ³¨å†Œé€»è¾‘ ====================

async def register_service():
    """å‘æ³¨å†Œä¸­å¿ƒæ³¨å†ŒæœåŠ¡"""
    async with httpx.AsyncClient() as client:
        try:
            response = await client.post(
                f"{REGISTRY_URL}/api/registry/register",
                json=SERVICE_CONFIG,
                timeout=10.0,
            )
            if response.status_code in [200, 201]:
                print(f"âœ… æœåŠ¡æ³¨å†ŒæˆåŠŸ: {SERVICE_CONFIG['name']}")
            else:
                print(f"âŒ æœåŠ¡æ³¨å†Œå¤±è´¥: {response.status_code}")
        except Exception as e:
            print(f"âŒ æ— æ³•è¿æ¥åˆ°æ³¨å†Œä¸­å¿ƒ: {e}")

async def send_heartbeat():
    """å®šæœŸå‘é€å¿ƒè·³"""
    while True:
        await asyncio.sleep(30)
        async with httpx.AsyncClient() as client:
            try:
                await client.post(
                    f"{REGISTRY_URL}/api/registry/heartbeat",
                    json={"service_id": SERVICE_CONFIG["name"]},
                    timeout=5.0,
                )
            except:
                pass

@app.on_event("startup")
async def startup_event():
    """å¯åŠ¨äº‹ä»¶"""
    print("ğŸš€ å¾…åŠäº‹é¡¹æœåŠ¡æ­£åœ¨å¯åŠ¨...")
    await register_service()
    asyncio.create_task(send_heartbeat())
    print(f"âœ… æœåŠ¡è¿è¡Œåœ¨ http://{SERVICE_CONFIG['host']}:{SERVICE_CONFIG['port']}")

@app.on_event("shutdown")
async def shutdown_event():
    """å…³é—­äº‹ä»¶"""
    print("ğŸ‘‹ å¾…åŠäº‹é¡¹æœåŠ¡æ­£åœ¨å…³é—­...")

# ==================== API ç«¯ç‚¹ ====================

@app.get("/")
async def root():
    """æ ¹ç«¯ç‚¹"""
    return {
        "service": SERVICE_CONFIG["display_name"],
        "version": SERVICE_CONFIG["version"],
        "total_todos": len(todos),
    }

@app.get("/health")
async def health():
    """å¥åº·æ£€æŸ¥"""
    return {"status": "healthy", "total_todos": len(todos)}

@app.get("/todos", response_model=List[Todo])
async def get_todos(completed: Optional[bool] = None):
    """è·å–æ‰€æœ‰å¾…åŠäº‹é¡¹"""
    if completed is None:
        return todos
    return [todo for todo in todos if todo.completed == completed]

@app.post("/todos", response_model=Todo)
async def create_todo(todo: TodoCreate):
    """åˆ›å»ºæ–°å¾…åŠäº‹é¡¹"""
    global todo_id_counter

    new_todo = Todo(
        id=todo_id_counter,
        title=todo.title,
        description=todo.description,
        completed=todo.completed,
    )
    todos.append(new_todo)
    todo_id_counter += 1

    return new_todo

@app.put("/todos/{todo_id}", response_model=Todo)
async def update_todo(todo_id: int, todo_update: TodoUpdate):
    """æ›´æ–°å¾…åŠäº‹é¡¹"""
    for todo in todos:
        if todo.id == todo_id:
            if todo_update.title is not None:
                todo.title = todo_update.title
            if todo_update.description is not None:
                todo.description = todo_update.description
            if todo_update.completed is not None:
                todo.completed = todo_update.completed
            return todo

    raise HTTPException(status_code=404, detail="å¾…åŠäº‹é¡¹æœªæ‰¾åˆ°")

@app.delete("/todos/{todo_id}")
async def delete_todo(todo_id: int):
    """åˆ é™¤å¾…åŠäº‹é¡¹"""
    global todos
    todos = [todo for todo in todos if todo.id != todo_id]
    return {"message": "å¾…åŠäº‹é¡¹å·²åˆ é™¤"}

# ==================== å¯åŠ¨æœåŠ¡ ====================

if __name__ == "__main__":
    import uvicorn
    uvicorn.run(
        app,
        host=SERVICE_CONFIG["host"],
        port=SERVICE_CONFIG["port"],
    )
```

### æ­¥éª¤ 3ï¼šå¯åŠ¨æœåŠ¡

```bash
# ç¡®ä¿å·²æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ
source /Users/town/Project/SAAS/backend/.venv/bin/activate

# å¯åŠ¨æœåŠ¡
python main.py
```

ä½ åº”è¯¥çœ‹åˆ°ï¼š
```
ğŸš€ å¾…åŠäº‹é¡¹æœåŠ¡æ­£åœ¨å¯åŠ¨...
âœ… æœåŠ¡æ³¨å†ŒæˆåŠŸ: todo-service
âœ… æœåŠ¡è¿è¡Œåœ¨ http://localhost:8100
INFO:     Uvicorn running on http://localhost:8100
```

### æ­¥éª¤ 4ï¼šæµ‹è¯•ä½ çš„æœåŠ¡

æ‰“å¼€æ–°ç»ˆç«¯ï¼Œæµ‹è¯• APIï¼š

```bash
# 1. åˆ›å»ºç¬¬ä¸€ä¸ªå¾…åŠäº‹é¡¹
curl -X POST http://localhost:8000/api/todo-service/todos \
  -H "Content-Type: application/json" \
  -d '{
    "title": "å­¦ä¹ å¾®æœåŠ¡",
    "description": "ç†è§£æœåŠ¡æ³¨å†Œå’Œå‘ç°æœºåˆ¶"
  }'

# 2. åˆ›å»ºç¬¬äºŒä¸ªå¾…åŠäº‹é¡¹
curl -X POST http://localhost:8000/api/todo-service/todos \
  -H "Content-Type: application/json" \
  -d '{
    "title": "å¼€å‘ç¬¬ä¸€ä¸ªæ’ä»¶",
    "description": "åˆ›å»ºå¾…åŠäº‹é¡¹æœåŠ¡"
  }'

# 3. è·å–æ‰€æœ‰å¾…åŠäº‹é¡¹
curl http://localhost:8000/api/todo-service/todos

# 4. æ ‡è®°ç¬¬ä¸€ä¸ªä»»åŠ¡ä¸ºå®Œæˆ
curl -X PUT http://localhost:8000/api/todo-service/todos/1 \
  -H "Content-Type: application/json" \
  -d '{
    "completed": true
  }'

# 5. åªè·å–æœªå®Œæˆçš„å¾…åŠäº‹é¡¹
curl http://localhost:8000/api/todo-service/todos?completed=false

# 6. åˆ é™¤å¾…åŠäº‹é¡¹
curl -X DELETE http://localhost:8000/api/todo-service/todos/1

# 7. æŸ¥çœ‹æœåŠ¡æ˜¯å¦å·²æ³¨å†Œ
curl http://localhost:8001/api/registry/services
```

### æ­¥éª¤ 5ï¼šæŸ¥çœ‹ API æ–‡æ¡£

æ‰“å¼€æµè§ˆå™¨è®¿é—®ï¼š
- http://localhost:8100/docs

ä½ ä¼šçœ‹åˆ°è‡ªåŠ¨ç”Ÿæˆçš„äº¤äº’å¼ API æ–‡æ¡£ï¼

---

## å‰ç«¯å¼€å‘

### å¯åŠ¨å‰ç«¯

```bash
cd frontend/admin

# å®‰è£…ä¾èµ–ï¼ˆé¦–æ¬¡è¿è¡Œï¼‰
npm install

# å¯åŠ¨å¼€å‘æœåŠ¡å™¨
npm run dev
```

è®¿é—®ï¼šhttp://localhost:5173

### åœ¨å‰ç«¯è°ƒç”¨ä½ çš„æœåŠ¡

ç¼–è¾‘ `frontend/admin/src/views/TodoList.vue`ï¼ˆæ–°å»ºæ–‡ä»¶ï¼‰ï¼š

```vue
<template>
  <div class="todo-list">
    <h1>å¾…åŠäº‹é¡¹</h1>

    <!-- æ·»åŠ æ–°å¾…åŠ -->
    <div class="add-todo">
      <input
        v-model="newTodo.title"
        placeholder="è¾“å…¥å¾…åŠäº‹é¡¹æ ‡é¢˜"
        @keyup.enter="addTodo"
      />
      <button @click="addTodo">æ·»åŠ </button>
    </div>

    <!-- å¾…åŠåˆ—è¡¨ -->
    <ul>
      <li v-for="todo in todos" :key="todo.id" :class="{ completed: todo.completed }">
        <input
          type="checkbox"
          v-model="todo.completed"
          @change="updateTodo(todo)"
        />
        <span>{{ todo.title }}</span>
        <button @click="deleteTodo(todo.id)">åˆ é™¤</button>
      </li>
    </ul>
  </div>
</template>

<script setup>
import { ref, onMounted } from 'vue'
import axios from 'axios'

const todos = ref([])
const newTodo = ref({ title: '', description: '' })

// è·å–å¾…åŠåˆ—è¡¨
const fetchTodos = async () => {
  const response = await axios.get('/api/todo-service/todos')
  todos.value = response.data
}

// æ·»åŠ å¾…åŠ
const addTodo = async () => {
  if (!newTodo.value.title) return

  await axios.post('/api/todo-service/todos', newTodo.value)
  newTodo.value = { title: '', description: '' }
  fetchTodos()
}

// æ›´æ–°å¾…åŠ
const updateTodo = async (todo) => {
  await axios.put(`/api/todo-service/todos/${todo.id}`, {
    completed: todo.completed
  })
}

// åˆ é™¤å¾…åŠ
const deleteTodo = async (id) => {
  await axios.delete(`/api/todo-service/todos/${id}`)
  fetchTodos()
}

onMounted(() => {
  fetchTodos()
})
</script>

<style scoped>
.todo-list {
  max-width: 600px;
  margin: 0 auto;
  padding: 20px;
}

.add-todo {
  display: flex;
  gap: 10px;
  margin-bottom: 20px;
}

.add-todo input {
  flex: 1;
  padding: 10px;
}

ul {
  list-style: none;
  padding: 0;
}

li {
  display: flex;
  align-items: center;
  gap: 10px;
  padding: 10px;
  border-bottom: 1px solid #eee;
}

li.completed span {
  text-decoration: line-through;
  color: #999;
}
</style>
```

---

## å¸¸è§é—®é¢˜

### 1. ç«¯å£è¢«å ç”¨

**é—®é¢˜ï¼š** å¯åŠ¨æœåŠ¡æ—¶æç¤ºç«¯å£å·²è¢«å ç”¨

**è§£å†³æ–¹æ¡ˆï¼š**
```bash
# æŸ¥çœ‹ç«¯å£å ç”¨
lsof -i :8000

# æ€æ­»å ç”¨è¿›ç¨‹
kill -9 <PID>

# æˆ–è€…ä¿®æ”¹æœåŠ¡é…ç½®ä½¿ç”¨å…¶ä»–ç«¯å£
```

### 2. æ•°æ®åº“è¿æ¥å¤±è´¥

**é—®é¢˜ï¼š** `FATAL: role "saas_user" does not exist`

**è§£å†³æ–¹æ¡ˆï¼š**
```bash
# åœæ­¢æœ¬åœ° PostgreSQLï¼ˆå¦‚æœæœ‰ï¼‰
brew services stop postgresql

# ä½¿ç”¨ Docker å¯åŠ¨
docker-compose up -d postgres

# æˆ–åˆ›å»ºæ•°æ®åº“ç”¨æˆ·
createuser -s saas_user
createdb -O saas_user saas_platform
```

### 3. æœåŠ¡æ³¨å†Œå¤±è´¥

**é—®é¢˜ï¼š** æ’ä»¶æœåŠ¡æ˜¾ç¤º"æœåŠ¡æ³¨å†Œå¤±è´¥"

**è§£å†³æ–¹æ¡ˆï¼š**
```bash
# 1. ç¡®è®¤æ³¨å†Œä¸­å¿ƒæ­£åœ¨è¿è¡Œ
curl http://localhost:8001

# 2. æ£€æŸ¥æœåŠ¡é…ç½®ä¸­çš„ REGISTRY_URL
# 3. æŸ¥çœ‹æ³¨å†Œä¸­å¿ƒæ—¥å¿—

# 4. æ¸…é™¤ä»£ç†è®¾ç½®ï¼ˆå¦‚æœæœ‰ï¼‰
unset ALL_PROXY
unset all_proxy
unset HTTPS_PROXY
unset https_proxy
```

### 4. è™šæ‹Ÿç¯å¢ƒé—®é¢˜

**é—®é¢˜ï¼š** æ‰¾ä¸åˆ° Python æ¨¡å—

**è§£å†³æ–¹æ¡ˆï¼š**
```bash
# ç¡®è®¤è™šæ‹Ÿç¯å¢ƒå·²æ¿€æ´»
which python
# åº”è¯¥æ˜¾ç¤º: /Users/town/Project/SAAS/backend/.venv/bin/python

# é‡æ–°å®‰è£…ä¾èµ–
cd backend
source .venv/bin/activate
uv pip install -r requirements.txt
```

### 5. å‰ç«¯ API è¯·æ±‚å¤±è´¥

**é—®é¢˜ï¼š** å‰ç«¯è¯·æ±‚è¿”å› CORS é”™è¯¯

**è§£å†³æ–¹æ¡ˆï¼š**
- ç¡®ä¿ä½¿ç”¨ `/api/` å‰ç¼€ï¼ˆä¼šè‡ªåŠ¨ä»£ç†åˆ°ç½‘å…³ï¼‰
- æ£€æŸ¥ `frontend/admin/vite.config.js` ä¸­çš„ä»£ç†é…ç½®
- ç¡®ä¿ç½‘å…³çš„ CORS é…ç½®æ­£ç¡®

### 6. Docker æœåŠ¡æ— æ³•å¯åŠ¨

**é—®é¢˜ï¼š** `docker-compose up` å¤±è´¥

**è§£å†³æ–¹æ¡ˆï¼š**
```bash
# æŸ¥çœ‹è¯¦ç»†é”™è¯¯
docker-compose up

# é‡æ–°æ„å»ºé•œåƒ
docker-compose build --no-cache

# æ¸…ç†å¹¶é‡å¯
docker-compose down -v
docker-compose up -d
```

---

## ä¸‹ä¸€æ­¥å­¦ä¹ 

1. âœ… å®Œæˆç¬¬ä¸€ä¸ªæ’ä»¶
2. ğŸ“– é˜…è¯» [æ’ä»¶å¼€å‘æŒ‡å—](./PLUGIN_DEVELOPMENT.md) äº†è§£æ›´å¤šé«˜çº§ç‰¹æ€§
3. ğŸ—ï¸ é˜…è¯» [æ¶æ„æ–‡æ¡£](./ARCHITECTURE.md) ç†è§£ç³»ç»Ÿè®¾è®¡
4. ğŸ” å­¦ä¹ å¦‚ä½•æ·»åŠ è®¤è¯å’Œæƒé™
5. ğŸš€ äº†è§£å¦‚ä½•éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒ

## è·å–å¸®åŠ©

- ğŸ“š æŸ¥çœ‹ `docs/` ç›®å½•ä¸‹çš„å…¶ä»–æ–‡æ¡£
- ğŸ› é‡åˆ°é—®é¢˜ï¼ŸæŸ¥çœ‹ [TROUBLESHOOTING.md](../TROUBLESHOOTING.md)
- ğŸ’¡ æœ‰æƒ³æ³•ï¼Ÿæ¬¢è¿æäº¤ Issue æˆ– Pull Request

---

**æ­å–œï¼** ä½ å·²ç»å®Œæˆäº†æ–°æ‰‹å…¥é—¨æ•™ç¨‹ï¼Œç°åœ¨å¯ä»¥å¼€å§‹æ„å»ºè‡ªå·±çš„å¾®æœåŠ¡åº”ç”¨äº†ï¼ğŸ‰
